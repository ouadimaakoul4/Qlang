<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QLang ‚Äî Biblioth√®que des Lois Universelles</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.2/marked.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1000px; 
            margin: 0 auto; 
            padding: 20px;
            background: linear-gradient(135deg, #0c2461 0%, #1e3799 100%);
            color: white;
            line-height: 1.6;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }
        .library-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        input, select { 
            width: 100%; 
            padding: 15px; 
            margin-bottom: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
        }
        button { 
            padding: 15px 30px; 
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            margin: 5px;
        }
        button:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }
        #response { 
            background: white;
            color: #333;
            border-radius: 10px;
            padding: 25px;
            margin-top: 25px;
            min-height: 100px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .law-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ff6b6b;
        }
        .domain-tag {
            display: inline-block;
            background: #4a69bd;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin: 2px;
            color: white;
        }
        .confidence-bar {
            height: 8px;
            background: #333;
            border-radius: 4px;
            margin: 5px 0;
        }
        .confidence-fill {
            height: 100%;
            background: #ff6b6b;
            border-radius: 4px;
        }
        .math-formula {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 3px solid #4a69bd;
            color: #333;
        }
        .latex-container {
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: #f1f3f4;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåå QLang ‚Äî Biblioth√®que des Lois Universelles</h1>
        <p>Explorez la connaissance cosmique √† travers les lois fondamentales de l'univers.</p>
        
        <input type="text" id="question" placeholder="Posez votre question cosmique...">
        <button onclick="askQLang()">‚ú® Interroger l'Univers</button>
        <button onclick="showLibrary()">üìö Voir la Biblioth√®que</button>
        <button onclick="showRandomLaw()">üé≤ Loi Al√©atoire</button>
        
        <div id="response">
            <p>La biblioth√®que contient <span id="law-count">0</span> lois universelles.</p>
        </div>
    </div>

    <script>
        // ==================== BIBLIOTH√àQUE DES LOIS UNIVERSELLES ====================

        const loisUniverselles = {
            // === PHYSIQUE FONDAMENTALE ===
            "thermodynamique_2": {
                "nom": "Deuxi√®me Loi de la Thermodynamique",
                "categorie": "physique_fondamentale",
                "domaines": ["thermodynamique", "entropie", "fleche_temps"],
                "√©nonc√©": "L'entropie d'un syst√®me isol√© ne peut que cro√Ætre ou rester constante",
                "√©nonc√©_latex": "\\\\Delta S \\\\geq 0",
                "formulation": "Dans tout processus naturel, l'entropie totale de l'univers augmente",
                "implications": [
                    "Fl√®che du temps irr√©versible",
                    "Impossibilit√© du mouvement perp√©tuel", 
                    "Mort thermique de l'univers comme √©tat final"
                ],
                "preuves": [
                    "Exp√©riences de calorim√©trie",
                    "Moteurs thermiques r√©els",
                    "Fondements statistiques (Boltzmann)"
                ],
                "limites": "Syst√®mes ouverts et loin de l'√©quilibre",
                "confiance": 0.99,
                "date_decouverte": "1850",
                "decouvreurs": ["Rudolf Clausius", "William Thomson"],
                "revolutions": ["thermodynamique", "cosmologie"]
            },

            "relativite_generale": {
                "nom": "Relativit√© G√©n√©rale", 
                "categorie": "physique_fondamentale",
                "domaines": ["gravitation", "espace_temps", "cosmologie"],
                "√©nonc√©": "La mati√®re et l'√©nergie courbent l'espace-temps, et cette courbure dicte le mouvement",
                "√©nonc√©_latex": "G_{\\\\mu\\\\nu} = \\\\frac{8\\\\pi G}{c^4} T_{\\\\mu\\\\nu}",
                "formulation": "√âquation d'Einstein reliant g√©om√©trie et contenu mat√©riel",
                "implications": [
                    "D√©flexion de la lumi√®re par les masses",
                    "Ondes gravitationnelles",
                    "Expansion de l'univers", 
                    "Trous noirs"
                ],
                "preuves": [
                    "D√©flexion stellaire lors des √©clipses (1919)",
                    "D√©calage vers le rouge gravitationnel", 
                    "Ondes gravitationnelles (LIGO 2015)"
                ],
                "confiance": 0.98,
                "date_decouverte": "1915",
                "decouvreurs": ["Albert Einstein"],
                "revolutions": ["gravitation", "cosmologie"]
            },

            "mecanique_quantique": {
                "nom": "Principes de la M√©canique Quantique",
                "categorie": "physique_fondamentale", 
                "domaines": ["quantique", "incertitude", "superposition"],
                "√©nonc√©": "Syst√®me d√©crit par une fonction d'onde, √©volution unitaire, mesure probabiliste",
                "√©nonc√©_latex": "i\\\\hbar\\\\frac{\\\\partial}{\\\\partial t}\\\\Psi = \\\\hat{H}\\\\Psi",
                "formulation": "√âquation de Schr√∂dinger d√©crivant l'√©volution temporelle",
                "implications": [
                    "Dualit√© onde-particule",
                    "Intrication quantique", 
                    "Principe d'incertitude",
                    "Effet tunnel"
                ],
                "preuves": [
                    "Exp√©rience de Stern-Gerlach",
                    "Interf√©rences avec particules individuelles",
                    "Calculateurs quantiques"
                ],
                "confiance": 0.99,
                "date_decouverte": "1925-1927", 
                "decouvreurs": ["Heisenberg", "Schr√∂dinger", "Dirac", "Bohr"]
            },

            // === COSMOLOGIE ===
            "expansion_hubble": {
                "nom": "Loi de Hubble-Lema√Ætre",
                "categorie": "cosmologie",
                "domaines": ["expansion", "cosmologie"], 
                "√©nonc√©": "Les galaxies s'√©loignent √† une vitesse proportionnelle √† leur distance",
                "√©nonc√©_latex": "v = H_0 d",
                "implications": [
                    "Univers en expansion",
                    "Big Bang comme origine", 
                    "√Çge fini de l'univers"
                ],
                "confiance": 0.95,
                "date_decouverte": "1927-1929",
                "decouvreurs": ["Georges Lema√Ætre", "Edwin Hubble"]
            },

            // === INFORMATION ET COMPLEXIT√â ===  
            "bekenstein": {
                "nom": "Limite de Bekenstein",
                "categorie": "information",
                "domaines": ["information", "gravit√©", "holographie"],
                "√©nonc√©": "Quantit√© maximale d'information contenue dans une r√©gion d'espace",
                "√©nonc√©_latex": "I \\\\leq \\\\frac{2\\\\pi R E}{\\\\hbar c \\\\ln 2}",
                "implications": [
                    "Principe holographique", 
                    "Entropie des trous noirs",
                    "Limites computationnelles fondamentales"
                ],
                "confiance": 0.90,
                "date_decouverte": "1973",
                "decouvreurs": ["Jacob Bekenstein"]
            },

            "landauer": {
                "nom": "Principe de Landauer", 
                "categorie": "information",
                "domaines": ["information", "thermodynamique", "computation"],
                "√©nonc√©": "Effacement d'un bit d'information dissipe au moins kT ln(2) d'√©nergie", 
                "√©nonc√©_latex": "E \\\\geq kT \\\\ln 2",
                "implications": [
                    "Lien information/entropie",
                    "Limites √©nerg√©tiques du calcul", 
                    "Ordinateurs r√©versibles"
                ],
                "confiance": 0.85,
                "date_decouverte": "1961",
                "decouvreurs": ["Rolf Landauer"]
            },

            // === AUTRES LOIS IMPORTANTES ===
            "equivalence_masse_energie": {
                "nom": "√âquivalence Masse-√ânergie",
                "categorie": "physique_fondamentale",
                "domaines": ["relativite", "energie", "masse"],
                "√©nonc√©": "La masse et l'√©nergie sont √©quivalentes et convertibles",
                "√©nonc√©_latex": "E = mc^2", 
                "implications": [
                    "√ânergie nucl√©aire",
                    "Cr√©ation et annihilation de particules",
                    "Courbure de l'espace-temps par l'√©nergie"
                ],
                "confiance": 0.99,
                "date_decouverte": "1905",
                "decouvreurs": ["Albert Einstein"]
            },

            "incertitude_heisenberg": {
                "nom": "Principe d'Incertitude de Heisenberg",
                "categorie": "physique_fondamentale", 
                "domaines": ["quantique", "incertitude", "mesure"],
                "√©nonc√©": "Impossibilit√© de conna√Ætre simultan√©ment avec pr√©cision certaines paires de propri√©t√©s",
                "√©nonc√©_latex": "\\\\Delta x \\\\Delta p \\\\geq \\\\frac{\\\\hbar}{2}",
                "implications": [
                    "Limites fondamentales de la mesure",
                    "Nature probabiliste de la r√©alit√© quantique",
                    "√ânergie du point z√©ro"
                ],
                "confiance": 0.98,
                "date_decouverte": "1927",
                "decouvreurs": ["Werner Heisenberg"]
            }
        };

        // ==================== FONCTIONS POUR MATHJAX ====================

        // Configuration de MathJax
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                tags: 'ams'
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };

        function renderMathJax() {
            if (window.MathJax && window.MathJax.typesetPromise) {
                MathJax.typesetPromise();
            }
        }

        function formatLatex(latexString) {
            if (!latexString) return '';
            // Nettoyer et formater le LaTeX pour MathJax
            return latexString.replace(/\\\\/g, '\\');
        }

        function createFormulaHTML(latexString, isDisplay = true) {
            if (!latexString) return '';
            const formatted = formatLatex(latexString);
            return isDisplay ? `$$${formatted}$$` : `$${formatted}$`;
        }

        // ==================== FONCTIONS PRINCIPALES ====================

        function getLoisAleatoires(n) {
            const cles = Object.keys(loisUniverselles);
            const resultat = [];
            const usedKeys = new Set();
            
            while (resultat.length < n && resultat.length < cles.length) {
                const cleAleatoire = cles[Math.floor(Math.random() * cles.length)];
                if (!usedKeys.has(cleAleatoire)) {
                    usedKeys.add(cleAleatoire);
                    resultat.push(loisUniverselles[cleAleatoire]);
                }
            }
            return resultat;
        }

        function mapperQuestion(question) {
            const questionLower = question.toLowerCase();
            let meilleurScore = 0;
            let meilleurType = null;

            const questionsTypes = {
                "fondamentalite_info": {
                    "mots_cles": ["information", "fondamentale", "mati√®re", "bit", "primitif"],
                    "lois": ["bekenstein", "landauer", "thermodynamique_2"],
                    "synthese_template": "L'information appara√Æt comme une entit√© fondamentale, peut-√™tre plus primitive que la mati√®re elle-m√™me."
                },
                "relativite": {
                    "mots_cles": ["relativit√©", "einstein", "espace-temps", "gravitation"],
                    "lois": ["relativite_generale", "equivalence_masse_energie"],
                    "synthese_template": "La relativit√© r√©volutionne notre compr√©hension de l'espace, du temps et de la gravitation."
                },
                "quantique": {
                    "mots_cles": ["quantique", "incertitude", "schr√∂dinger", "heisenberg"],
                    "lois": ["mecanique_quantique", "incertitude_heisenberg"],
                    "synthese_template": "Le monde quantique r√©v√®le une r√©alit√© probabiliste et contre-intuitive."
                },
                "thermodynamique": {
                    "mots_cles": ["entropie", "thermodynamique", "d√©sordre", "ordre"],
                    "lois": ["thermodynamique_2", "landauer"],
                    "synthese_template": "La thermodynamique gouverne les transformations √©nerg√©tiques et d√©finit la fl√®che du temps."
                },
                "cosmologie": {
                    "mots_cles": ["univers", "expansion", "big bang", "cosmologie"],
                    "lois": ["expansion_hubble", "relativite_generale"],
                    "synthese_template": "La cosmologie moderne r√©v√®le un univers en expansion, n√© d'un √©tat primordial extr√™me."
                }
            };

            for (const [type, data] of Object.entries(questionsTypes)) {
                const score = data.mots_cles.filter(mot => 
                    questionLower.includes(mot)
                ).length;
                
                if (score > meilleurScore) {
                    meilleurScore = score;
                    meilleurType = type;
                }
            }

            return meilleurType ? questionsTypes[meilleurType] : null;
        }

        function genererReponse(question) {
            const typeQuestion = mapperQuestion(question);
            
            if (!typeQuestion) {
                const loisAleatoires = getLoisAleatoires(3);
                return `### üîç Aucune Correspondance Directe

**Question** : "${question}"

Aucune cat√©gorie sp√©cifique n'a √©t√© identifi√©e. Voici quelques lois universelles pertinentes :

${loisAleatoires.map(loi => 
    `- **${loi.nom}** : ${loi.√©nonc√©}`
).join('\n')}

**Suggestions** : Reformulez en utilisant des termes comme "information", "relativit√©", "quantique", "expansion", etc.`;
            }

            const loisInvoquees = typeQuestion.lois.map(cle => loisUniverselles[cle]);
            const confianceMoyenne = loisInvoquees.reduce((sum, loi) => sum + loi.confiance, 0) / loisInvoquees.length;

            let markdown = `### üåü Analyse par QLang

**Question** : "${question}"

**Cat√©gorie identifi√©e** : ${typeQuestion.mots_cles.join(', ')}

**Synth√®se** : ${typeQuestion.synthese_template}

---

## üìú Lois Universelles Invoqu√©es

`;

            loisInvoquees.forEach(loi => {
                const formuleHTML = loi.√©nonc√©_latex ? createFormulaHTML(loi.√©nonc√©_latex, true) : '';
                
                markdown += `### ${loi.nom}

**Domaine** : ${loi.domaines.map(d => `\`${d}\``).join(', ')}

**√ânonc√©** : ${loi.√©nonc√©}

${formuleHTML ? `**Formulation math√©matique** : 

${formuleHTML}

` : ''}

**Implications** : ${loi.implications.join('; ')}

**Niveau de confiance** : ${(loi.confiance * 100).toFixed(0)}%

---
`;
            });

            markdown += `**Confiance globale** : ${(confianceMoyenne * 100).toFixed(1)}%
**Nombre de lois invoqu√©es** : ${loisInvoquees.length}`;

            return markdown;
        }

        function showLibrary() {
            const categories = {};
            
            Object.values(loisUniverselles).forEach(loi => {
                if (!categories[loi.categorie]) {
                    categories[loi.categorie] = [];
                }
                categories[loi.categorie].push(loi);
            });

            let html = `<h2>üìö Biblioth√®que des Lois Universelles</h2>
                       <p><strong>${Object.keys(loisUniverselles).length} lois catalogu√©es</strong></p>`;

            for (const [categorie, lois] of Object.entries(categories)) {
                html += `<div class="library-section">
                        <h3>${categorie.replace(/_/g, ' ').toUpperCase()} (${lois.length} lois)</h3>`;
                
                lois.forEach(loi => {
                    const formule = loi.√©nonc√©_latex ? 
                        `<div class="latex-container">${createFormulaHTML(loi.√©nonc√©_latex, true)}</div>` : '';
                    
                    html += `<div class="law-card">
                            <h4>${loi.nom}</h4>
                            <p><strong>√ânonc√© :</strong> ${loi.√©nonc√©}</p>
                            ${formule}
                            <div>${loi.domaines.map(d => `<span class="domain-tag">${d}</span>`).join('')}</div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: ${loi.confiance * 100}%"></div>
                            </div>
                            <small>Confiance: ${(loi.confiance * 100).toFixed(0)}% | ${loi.date_decouverte} | ${Array.isArray(loi.decouvreurs) ? loi.decouvreurs.join(', ') : loi.decouvreurs}</small>
                        </div>`;
                });
                
                html += `</div>`;
            }

            document.getElementById('response').innerHTML = html;
            // Forcer le rendu MathJax apr√®s l'insertion du HTML
            setTimeout(renderMathJax, 100);
        }

        function showRandomLaw() {
            const lois = Object.values(loisUniverselles);
            const loiAleatoire = lois[Math.floor(Math.random() * lois.length)];
            const formule = loiAleatoire.√©nonc√©_latex ? 
                `<div class="latex-container">${createFormulaHTML(loiAleatoire.√©nonc√©_latex, true)}</div>` : '';
            
            const html = `<div class="law-card">
                <h3>üé≤ Loi Al√©atoire</h3>
                <h4>${loiAleatoire.nom}</h4>
                <p><strong>√ânonc√© :</strong> ${loiAleatoire.√©nonc√©}</p>
                ${formule}
                <p><strong>Domaine :</strong> ${loiAleatoire.domaines.join(', ')}</p>
                <p><strong>Implications :</strong> ${loiAleatoire.implications.join('; ')}</p>
                <p><strong>D√©couvreurs :</strong> ${Array.isArray(loiAleatoire.decouvreurs) ? loiAleatoire.decouvreurs.join(', ') : loiAleatoire.decouvreurs}</p>
                <p><strong>Date :</strong> ${loiAleatoire.date_decouverte}</p>
                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: ${loiAleatoire.confiance * 100}%"></div>
                </div>
                <small>Niveau de confiance: ${(loiAleatoire.confiance * 100).toFixed(0)}%</small>
            </div>`;
            
            document.getElementById('response').innerHTML = html;
            setTimeout(renderMathJax, 100);
        }

        // ==================== INTERFACE UTILISATEUR ====================

        async function askQLang() {
            const question = document.getElementById('question').value.trim();
            const responseDiv = document.getElementById('response');

            if (!question) {
                responseDiv.innerHTML = "<p>üå† Veuillez poser une question cosmique.</p>";
                return;
            }

            responseDiv.innerHTML = "<p>üåÄ Consultation des archives universelles...</p>";

            await new Promise(resolve => setTimeout(resolve, 1000));

            try {
                const reponseMarkdown = genererReponse(question);
                const reponseHTML = marked.parse(reponseMarkdown);
                responseDiv.innerHTML = reponseHTML;
                // Forcer le rendu MathJax apr√®s l'insertion du HTML
                setTimeout(renderMathJax, 100);
            } catch (error) {
                responseDiv.innerHTML = `<p>‚ùå Erreur dans le continuum espace-temps: ${error.message}</p>`;
            }
        }

        // ==================== INITIALISATION ====================

        function init() {
            // Mettre √† jour le compteur de lois
            document.getElementById('law-count').textContent = Object.keys(loisUniverselles).length;
            
            // Afficher la biblioth√®que au d√©marrage
            showLibrary();
            
            console.log('QLang initialis√© avec', Object.keys(loisUniverselles).length, 'lois universelles');
        }

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', init);

        // Permettre d'utiliser la touche Entr√©e
        document.getElementById('question').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                askQLang();
            }
        });

        // Focus sur le champ de question
        document.getElementById('question').focus();
    </script>
</body>
</html>
