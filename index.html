<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QLang ‚Äî Biblioth√®que des Lois Universelles</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.2/marked.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1000px; 
            margin: 0 auto; 
            padding: 20px;
            background: linear-gradient(135deg, #0c2461 0%, #1e3799 100%);
            color: white;
            line-height: 1.6;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }
        .library-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        input, select, textarea { 
            width: 100%; 
            padding: 10px; 
            margin-bottom: 10px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
        }
        button { 
            padding: 12px 20px; 
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            margin: 5px;
        }
        button:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }
        #response { 
            background: white;
            color: #333;
            border-radius: 10px;
            padding: 25px;
            margin-top: 25px;
            min-height: 100px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .law-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ff6b6b;
        }
        .domain-tag {
            display: inline-block;
            background: #4a69bd;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin: 2px;
            color: white;
        }
        .confidence-bar {
            height: 8px;
            background: #333;
            border-radius: 4px;
            margin: 5px 0;
        }
        .confidence-fill {
            height: 100%;
            background: #ff6b6b;
            border-radius: 4px;
        }
        .latex-container {
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: #f1f3f4;
            border-radius: 8px;
            color: #333;
        }
        .editor-section {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        .enrich-buttons {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåå QLang ‚Äî Biblioth√®que des Lois Universelles</h1>
        <p>Explorez la connaissance cosmique √† travers les lois fondamentales de l'univers.</p>
        
        <input type="text" id="question" placeholder="Posez votre question cosmique...">
        <button onclick="askQLang()">‚ú® Interroger l'Univers</button>
        <button onclick="showLibrary()">üìö Voir la Biblioth√®que</button>
        <button onclick="showRandomLaw()">üé≤ Loi Al√©atoire</button>
        
        <!-- SECTION ENRICHISSEMENT -->
        <div class="enrich-buttons">
            <h3>üéØ Enrichir la Biblioth√®que</h3>
            <button onclick="generer10LoisAutomatiquement()" style="background: #9b59b6;">
                üß† G√©n√©rer 10 Lois Auto
            </button>
            <button onclick="afficherEditeur()" style="background: #2ecc71;">
                ‚úèÔ∏è Ajouter Une Loi
            </button>
            <button onclick="exporterBibliotheque()" style="background: #e74c3c;">
                üì• Exporter en JSON
            </button>
        </div>
        
        <div id="response">
            <p>La biblioth√®que contient <span id="law-count">0</span> lois universelles.</p>
        </div>
    </div>

    <script>
        // ==================== BIBLIOTH√àQUE DE BASE ====================
        let loisUniverselles = {
            "thermodynamique_2": {
                "nom": "Deuxi√®me Loi de la Thermodynamique",
                "categorie": "physique_fondamentale",
                "domaines": ["thermodynamique", "entropie", "fleche_temps"],
                "√©nonc√©": "L'entropie d'un syst√®me isol√© ne peut que cro√Ætre ou rester constante",
                "√©nonc√©_latex": "\\\\Delta S \\\\geq 0",
                "implications": ["Fl√®che du temps irr√©versible", "Impossibilit√© du mouvement perp√©tuel", "Mort thermique de l'univers"],
                "confiance": 0.99,
                "date_decouverte": "1850",
                "decouvreurs": ["Rudolf Clausius", "William Thomson"]
            },
            "relativite_generale": {
                "nom": "Relativit√© G√©n√©rale", 
                "categorie": "physique_fondamentale",
                "domaines": ["gravitation", "espace_temps", "cosmologie"],
                "√©nonc√©": "La mati√®re et l'√©nergie courbent l'espace-temps, et cette courbure dicte le mouvement",
                "√©nonc√©_latex": "G_{\\\\mu\\\\nu} = \\\\frac{8\\\\pi G}{c^4} T_{\\\\mu\\\\nu}",
                "implications": ["D√©flexion de la lumi√®re", "Ondes gravitationnelles", "Expansion de l'univers", "Trous noirs"],
                "confiance": 0.98,
                "date_decouverte": "1915",
                "decouvreurs": ["Albert Einstein"]
            }
        };

        // ==================== G√âN√âRATEUR AUTOMATIQUE SIMPLE ====================

        function generer10LoisAutomatiquement() {
            const nouvellesLois = {};
            const categories = ["physique_fondamentale", "cosmologie", "quantique", "thermodynamique", "electromagnetisme"];
            const auteurs = ["Newton", "Einstein", "Maxwell", "Planck", "Heisenberg", "Schr√∂dinger", "Dirac", "Feynman", "Bohr", "Faraday"];
            const concepts = ["conservation", "invariance", "sym√©trie", "√©quilibre", "fluctuation", "√©volution", "stabilit√©"];
            
            for (let i = 0; i < 10; i++) {
                const id = 'auto_' + Date.now() + '_' + i;
                const categorie = categories[Math.floor(Math.random() * categories.length)];
                const auteur = auteurs[Math.floor(Math.random() * auteurs.length)];
                const concept = concepts[Math.floor(Math.random() * concepts.length)];
                
                nouvellesLois[id] = {
                    nom: `Loi de ${auteur} sur la ${concept}`,
                    categorie: categorie,
                    domaines: [categorie, "fondamental"],
                    enonc√©: `La ${concept} d'un syst√®me isol√© reste constante au cours du temps.`,
                    enonce_latex: Math.random() > 0.5 ? "E = k \\\\log W" : null,
                    implications: ["Cons√©quence fondamentale", "Application universelle", "V√©rification exp√©rimentale"],
                    confiance: 0.7 + Math.random() * 0.25,
                    date_decouverte: (1800 + Math.floor(Math.random() * 200)).toString(),
                    decouvreurs: [auteur]
                };
            }
            
            // Fusionner avec les lois existantes
            Object.assign(loisUniverselles, nouvellesLois);
            
            // Mettre √† jour l'affichage
            document.getElementById('law-count').textContent = Object.keys(loisUniverselles).length;
            showLibrary();
            
            alert(`‚úÖ 10 nouvelles lois g√©n√©r√©es ! Total: ${Object.keys(loisUniverselles).length} lois`);
        }

        // ==================== √âDITEUR MANUEL SIMPLE ====================

        function afficherEditeur() {
            const htmlEditeur = `
                <div class="editor-section">
                    <h3>‚úèÔ∏è Ajouter une Nouvelle Loi</h3>
                    
                    <div style="display: grid; gap: 10px; grid-template-columns: 1fr 1fr;">
                        <div>
                            <label>Nom de la loi:</label>
                            <input type="text" id="nom-loi" placeholder="Ex: Loi de conservation de l'√©nergie">
                        </div>
                        
                        <div>
                            <label>Cat√©gorie:</label>
                            <select id="categorie-loi">
                                <option value="physique_fondamentale">Physique Fondamentale</option>
                                <option value="cosmologie">Cosmologie</option>
                                <option value="quantique">M√©canique Quantique</option>
                                <option value="thermodynamique">Thermodynamique</option>
                                <option value="information">Information</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label>√ânonc√©:</label>
                        <textarea id="enonce-loi" placeholder="Description de la loi..." style="width: 100%; height: 60px;"></textarea>
                    </div>

                    <div>
                        <label>Formule LaTeX (optionnel):</label>
                        <input type="text" id="latex-loi" placeholder="Ex: E = mc^2" style="width: 100%;">
                    </div>

                    <div>
                        <label>Implications (s√©par√©es par des virgules):</label>
                        <input type="text" id="implications-loi" placeholder="cons√©quence1, cons√©quence2, ..." style="width: 100%;">
                    </div>

                    <button onclick="ajouterLoiManuellement()" style="background: #27ae60; width: 100%;">
                        ‚úÖ Ajouter la Loi √† la Biblioth√®que
                    </button>
                    
                    <button onclick="showLibrary()" style="background: #95a5a6; width: 100%; margin-top: 10px;">
                        ‚ùå Annuler
                    </button>
                </div>
            `;
            
            document.getElementById('response').innerHTML = htmlEditeur;
        }

        function ajouterLoiManuellement() {
            const nom = document.getElementById('nom-loi').value;
            const categorie = document.getElementById('categorie-loi').value;
            const enonce = document.getElementById('enonce-loi').value;
            const latex = document.getElementById('latex-loi').value;
            const implicationsTexte = document.getElementById('implications-loi').value;
            
            if (!nom || !enonce) {
                alert('‚ùå Veuillez remplir au moins le nom et l\'√©nonc√© de la loi');
                return;
            }
            
            const implications = implicationsTexte ? implicationsTexte.split(',').map(i => i.trim()) : ["√Ä pr√©ciser"];

            const id = 'manuelle_' + Date.now();
            
            loisUniverselles[id] = {
                nom: nom,
                categorie: categorie,
                domaines: [categorie],
                enonc√©: enonce,
                enonc√©_latex: latex || null,
                implications: implications,
                confiance: 0.8,
                date_decouverte: new Date().getFullYear().toString(),
                decouvreurs: ["Utilisateur"]
            };

            // Mettre √† jour l'affichage
            document.getElementById('law-count').textContent = Object.keys(loisUniverselles).length;
            showLibrary();
            
            alert('‚úÖ Loi ajout√©e avec succ√®s !');
        }

        // ==================== FONCTIONS EXISTANTES (√† garder) ====================

        function exporterBibliotheque() {
            const dataStr = JSON.stringify(loisUniverselles, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', 'lois_universelles.json');
            linkElement.click();
            
            alert('üì• Biblioth√®que export√©e !');
        }

        function showLibrary() {
            const categories = {};
            
            Object.values(loisUniverselles).forEach(loi => {
                if (!categories[loi.categorie]) {
                    categories[loi.categorie] = [];
                }
                categories[loi.categorie].push(loi);
            });

            let html = `<h2>üìö Biblioth√®que des Lois Universelles</h2>
                       <p><strong>${Object.keys(loisUniverselles).length} lois catalogu√©es</strong></p>`;

            for (const [categorie, lois] of Object.entries(categories)) {
                html += `<div class="library-section">
                        <h3>${categorie.replace(/_/g, ' ').toUpperCase()} (${lois.length} lois)</h3>`;
                
                lois.forEach(loi => {
                    const formule = loi.√©nonc√©_latex ? 
                        `<div class="latex-container">\${loi.√©nonc√©_latex.replace(/\\\\/g, '\\')}</div>` : '';
                    
                    html += `<div class="law-card">
                            <h4>${loi.nom}</h4>
                            <p><strong>√ânonc√© :</strong> ${loi.√©nonc√©}</p>
                            ${formule}
                            <div>${loi.domaines.map(d => `<span class="domain-tag">${d}</span>`).join('')}</div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: ${loi.confiance * 100}%"></div>
                            </div>
                            <small>Confiance: ${(loi.confiance * 100).toFixed(0)}% | ${loi.date_decouverte} | ${Array.isArray(loi.decouvreurs) ? loi.decouvreurs.join(', ') : loi.decouvreurs}</small>
                        </div>`;
                });
                
                html += `</div>`;
            }

            document.getElementById('response').innerHTML = html;
            setTimeout(() => {
                if (window.MathJax) {
                    MathJax.typesetPromise && MathJax.typesetPromise();
                }
            }, 100);
        }

        function showRandomLaw() {
            const lois = Object.values(loisUniverselles);
            if (lois.length === 0) {
                document.getElementById('response').innerHTML = "<p>Aucune loi dans la biblioth√®que.</p>";
                return;
            }
            
            const loiAleatoire = lois[Math.floor(Math.random() * lois.length)];
            const formule = loiAleatoire.√©nonc√©_latex ? 
                `<div class="latex-container">${loiAleatoire.√©nonc√©_latex.replace(/\\\\/g, '\\')}</div>` : '';
            
            const html = `<div class="law-card">
                <h3>üé≤ Loi Al√©atoire</h3>
                <h4>${loiAleatoire.nom}</h4>
                <p><strong>√ânonc√© :</strong> ${loiAleatoire.√©nonc√©}</p>
                ${formule}
                <p><strong>Domaine :</strong> ${loiAleatoire.domaines.join(', ')}</p>
                <p><strong>Implications :</strong> ${loiAleatoire.implications.join('; ')}</p>
                <p><strong>D√©couvreurs :</strong> ${Array.isArray(loiAleatoire.decouvreurs) ? loiAleatoire.decouvreurs.join(', ') : loiAleatoire.decouvreurs}</p>
                <p><strong>Date :</strong> ${loiAleatoire.date_decouverte}</p>
                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: ${loiAleatoire.confiance * 100}%"></div>
                </div>
                <small>Niveau de confiance: ${(loiAleatoire.confiance * 100).toFixed(0)}%</small>
            </div>`;
            
            document.getElementById('response').innerHTML = html;
            setTimeout(() => {
                if (window.MathJax) {
                    MathJax.typesetPromise && MathJax.typesetPromise();
                }
            }, 100);
        }

        async function askQLang() {
            const question = document.getElementById('question').value.trim();
            const responseDiv = document.getElementById('response');

            if (!question) {
                responseDiv.innerHTML = "<p>üå† Veuillez poser une question cosmique.</p>";
                return;
            }

            responseDiv.innerHTML = "<p>üåÄ Consultation des archives universelles...</p>";

            await new Promise(resolve => setTimeout(resolve, 1000));

            // R√©ponse simple bas√©e sur les mots-cl√©s
            const questionLower = question.toLowerCase();
            let reponse = `### üåü R√©ponse √†: "${question}"\n\n`;
            
            if (questionLower.includes('thermodynamique') || questionLower.includes('entropie')) {
                reponse += "**Domaine identifi√©:** Thermodynamique\n\n";
                reponse += "Les lois thermodynamiques gouvernent les transformations √©nerg√©tiques et d√©finissent la fl√®che du temps.\n\n";
                reponse += "**Lois pertinentes:**\n";
                reponse += "- Deuxi√®me loi de la thermodynamique\n";
                reponse += "- Principe de conservation de l'√©nergie\n";
            } else if (questionLower.includes('quantique') || questionLower.includes('atome')) {
                reponse += "**Domaine identifi√©:** M√©canique Quantique\n\n";
                reponse += "Le monde quantique r√©v√®le une r√©alit√© probabiliste aux √©chelles subatomiques.\n\n";
                reponse += "**Concepts cl√©s:** superposition, intrication, incertitude\n";
            } else {
                reponse += "**Analyse g√©n√©rale**\n\n";
                reponse += `Votre question "${question}" touche √† des concepts universels. \n\n`;
                reponse += `La biblioth√®que contient ${Object.keys(loisUniverselles).length} lois pour explorer ces questions.`;
            }
            
            reponse += `\n\n*Bas√© sur ${Object.keys(loisUniverselles).length} lois universelles catalogu√©es*`;

            responseDiv.innerHTML = marked.parse(reponse);
        }

        // ==================== INITIALISATION ====================

        function init() {
            document.getElementById('law-count').textContent = Object.keys(loisUniverselles).length;
            showLibrary();
        }

        document.addEventListener('DOMContentLoaded', init);
        document.getElementById('question').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') askQLang();
        });
    </script>
</body>
</html>
